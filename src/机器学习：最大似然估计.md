---
title: 机器学习：最大似然估计
date: 2019-05-03 14:18:14
tags:
  - Machine Learning
---

### Maximum Likelihood Estimation(MLE)

> 给定一个概率分布$D$, 已知其概率质量函数或者概率密度函数为$f_{D}$, 以及关于分布的一个未知参数$\theta$, 可以从分布中随机抽取样本大小为$n$的样本, 记为: $X_{1}, X_{2}, \cdots, X_{n}$, 利用$f_{D}$可计算出其似然函数:
> $$
> L(\theta;x_{1}, x_{2}, \cdots, x_{n}) = f_{\theta}(x_{1}, x_{2}, \cdots, x_{n})
> $$
>
> - $D$为离散分布, $f_{\theta}$表示参数为$\theta$时这一观测值的概率
> - $D$为连续分布, $f_{\theta}$则为$X_{1}, X_{2}, \cdots, X_{n}$联合分布的概率密度函数在观测值处的取值
>
> 最大似然原理:
>
> 可以在$\theta$的所有可能取值中寻找一个值使得似然函数取到最大值
>
> 这个使可能性最大的$\hat{\theta}$值即称为$\theta$的**最大似然估计**

<!--more-->

#### Example

设产品分为合格品与不合格品两类, 我们用一个随机变量$X$来表示某个产品经检查后的不合格品数, 则$X = 0$表示合格品, $X = 1$表示不合格品, 则$X$服从伯努利分布$B(1, p)$, 其中$p$是未知的不合格品率。现抽取$n$个产品看其是否合格, 得到样本$x_{1}, x_{2}, \cdots, x_{n}$, 这批观测值发生的概率为:
$$
P(x_{1}, \cdots, x_{n}; p) = \prod_{i = 1}^{n}p^{x_{i}}(1 - p)^{1 - x_{i}} = p^{\sum_{i = 1}^{n}x_{i}}(1 - p)^{n - \sum_{i = 1}^{n}x_{i}}
$$
由于$p$是未知的, 根据最大似然原理, 应选择$p$使得上式的概率尽可能大, 上式即为似然函数$L(p)$

对数似然函数$\ln L(p)$:
$$
\ln L(p) = \sum_{i = 1}^{n}x_{i} \ln p + (n - \sum_{i = 1}^{n}x_{i}) \ln (1 - p)
$$
对$p$求导并令其为0, 可得似然方程:
$$
\frac{\partial \ln L(p)}{\partial p} = \frac{\sum_{i = 1}^{n}x_{i}}{p} - \frac{n - \sum_{i = 1}^{n}x_{i}}{1 - p} = 0
$$
可得$p$的最大似然估计为:
$$
\hat{p} = \sum_{i = 1}^{n} \frac{x_{i}}{n} = \bar{x}
$$

> - 样本的概率函数是参数已知, 关于样本的函数
> - 似然函数是样本观测值已知, 关于参数的函数